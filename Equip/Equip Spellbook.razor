@clearignore

if findtype 'spellbook' backpack 0 as book
    getlabel book bookName
    if 'blessed' in bookName
        @ignore book
    endif
endif

if findtype 'spellbook' self 2599 as book
    dclick book
    while not lhandempty
    endwhile
    overhead 'Void Spellbook Equipped' 14
elseif findtype 'spellbook' self 2503 as book
    dclick book
    while not lhandempty
    endwhile
    overhead 'War Spellbook Equipped' 36
elseif findtype 'spellbook' self as book
    dclick book
    while not lhandempty
    endwhile
    overhead 'Spellbook Equipped' 920
else
    overhead 'Aspect spellbook not found!' 38
endif


# try to move other stuff into bag
if findtype 'bag' backpack 0 as myBag 
    # move aspected bow
    @setvar! foundBow 0
    if findtype 'bow' self 2599 as aspectBow
        @setvar! foundBow aspectBow
    elseif findtype 'bow' self 2503 as aspectBow
        @setvar! foundBow aspectBow
    elseif findtype 'bow' self 1790 as aspectBow
        @setvar! foundBow aspectBow
    else 
        while findtype 'bow' self as regBow
            getlabel regBow bowName
            if 'exceptional' in bowName
                @setvar! foundBow regBow
                break
            else
                @ignore regBow
            endif
        endwhile
    endif
    if foundBow > 0 and not find foundBow myBag
        lift foundBow
        drop myBag -1 -1 -1
        #overhead 'stashing bow'
        wait 250
    endif
    
    # move aspected xbow
    @setvar! foundXbow 0
    if findtype 'crossbow' self 2599 as aspectBow
        @setvar! foundXbow aspectBow
    elseif findtype 'crossbow' self 2503 as aspectBow
        @setvar! foundXbow aspectBow
    elseif findtype 'crossbow' self 1790 as aspectBow
        @setvar! foundXbow aspectBow
    else 
        while findtype 'crossbow' self as regBow
            getlabel regBow bowName
            if 'exceptional' in bowName
                @setvar! foundXbow regBow
                break
            else
                @ignore regBow
            endif
        endwhile
    endif
    if foundXbow > 0 and not find foundXbow myBag
        lift foundXbow
        drop myBag -1 -1 -1
        #overhead 'stashing xbow'
        wait 250
    endif
    
    # move aspected heavy xbow
    @setvar! foundHeavyXbow 0
    if findtype 'heavy crossbow' self 2599 as aspectBow
        @setvar! foundHeavyXbow aspectBow
    elseif findtype 'heavy crossbow' self 2503 as aspectBow
        @setvar! foundHeavyXbow aspectBow
    elseif findtype 'heavy crossbow' self 1790 as aspectBow
        @setvar! foundHeavyXbow aspectBow
    else 
        while findtype 'heavy crossbow' self as regBow
            getlabel regBow bowName
            if 'exceptional' in bowName
                @setvar! foundHeavyXbow regBow
                break
            else
                @ignore regBow
            endif
        endwhile
    endif
    if foundHeavyXbow > 0 and not find foundHeavyXbow myBag
        lift foundHeavyXbow
        drop myBag -1 -1 -1
        #overhead 'stashing heavy xbow'
        wait 250
    endif
else
    overhead 'NO BAG FOUND!' 38
    stop
endif