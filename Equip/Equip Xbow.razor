if findtype 'crossbow' lefthand
    overhead 'Already Equipped!' 54
    stop
endif

# 2599 == void aspect
if findtype 'crossbow' self 2599 as bow 
    dclick bow
    while rhandempty
    endwhile
    overhead 'Void Xbow Equipped' 14
# 2504 == war aspect
elseif findtype 'crossbow' self 2503 as bow 
    dclick bow
    while rhandempty
    endwhile
    overhead 'War Xbow Equipped' 36
# normal
elseif findtype 'crossbow' self as bow
    dclick bow
    while rhandempty
    endwhile
    overhead 'Xbow Equipped' 920
else
    overhead 'Xbow not found!' 38
endif


# try to move other stuff into bag
if findtype 'bag' backpack 0 as bag 
    # move aspected bow
    @setvar! foundBow 0
    if findtype 'bow' self 2599 as aspectBow
        @setvar! foundBow aspectBow
    elseif findtype 'bow' self 2503 as aspectBow
        @setvar! foundBow aspectBow
    elseif findtype 'bow' self 1790 as aspectBow
        @setvar! foundBow aspectBow
    endif
    if foundBow > 0 and not find foundBow bag
        lift foundBow
        drop bag -1 -1 -1
        #overhead 'stashing bow'
        wait 250
    endif
    
    # move aspected heavy xbow
    @setvar! foundHeavyXbow 0
    if findtype 'heavy crossbow' self 2599 as aspectBow
        @setvar! foundHeavyXbow aspectBow
    elseif findtype 'heavy crossbow' self 2503 as aspectBow
        @setvar! foundHeavyXbow aspectBow
    elseif findtype 'heavy crossbow' self 1790 as aspectBow
        @setvar! foundHeavyXbow aspectBow
    endif
    if foundHeavyXbow > 0 and not find foundHeavyXbow bag
        lift foundHeavyXbow
        drop bag -1 -1 -1
        #overhead 'stashing heavy xbow'
        wait 250
    endif
    
    # move spellbook
    @setvar! foundBook 0
    if findtype 'spellbook' self 2599 as book
        @setvar! foundBook book
    elseif findtype 'spellbook' self 2503 as book
        @setvar! foundBook book
    elseif findtype 'spellbook' self as book
        @setvar! foundBook book
    endif
    if foundBook > 0 and not find foundBook bag
        lift foundBook
        drop bag -1 -1 -1
        #overhead 'stashing spellbook'
        wait 250
    endif
else
    overhead 'NO BAG FOUND!' 38
    stop
endif